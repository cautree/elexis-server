#
# SQL init for ch.elexis.data.Anwender
# MEDEVIT <office@medevit.at>
#
# See https://redmine.medelexis.ch/issues/2112
#
CREATE TABLE USER_ (
  ID VARCHAR(25) NOT NULL,				# the username is the id
  DELETED CHAR(1) DEFAULT '0',
  KONTAKT_ID VARCHAR(25),				# foreign key to contact table
  LASTUPDATE BIGINT,
  HASHED_PASSWORD VARCHAR(64),			# Currently SHA-256
  SALT VARCHAR(64),						# The SALT used for SHA256_PASSWORD hash
  IS_ACTIVE CHAR(1) DEFAULT '1', 		# Is this account currently active? If not, any log-in is to be prohibited.
  IS_ADMINISTRATOR CHAR(1) DEFAULT '0',	# User is an administrator
  KEYSTORE TEXT,							# For key based authentication or signature purposes
  APIKEY VARCHAR(64),
  EXTINFO BLOB,
  PRIMARY KEY (ID)
);

CREATE UNIQUE INDEX APIKEY_UNIQUE ON USER_ (APIKEY ASC);

# default password is 'administrator'
# http://java.dzone.com/articles/secure-password-storage-lots
INSERT INTO `KONTAKT` VALUES ('e235e85d7ddad313202',1470809122981,'0','0','0','0','1','0','0',NULL,NULL,NULL,NULL,NULL,'Administrator',NULL,'Administrator',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);
INSERT INTO USER_ (ID, IS_ADMINISTRATOR, SALT, HASHED_PASSWORD, APIKEY, KONTAKT_ID) 
	VALUES ('Administrator', '1', '1254bb9a05856b9e', 'b94a0b6fc7be97e0a1585ac85e814d3852668968', 'b94a0b6fc7be97e0a1585ac85e814d3852668968', 'e235e85d7ddad313202');

# DEFAULT password IS 'user'
INSERT INTO `KONTAKT` VALUES ('h2c1172107ce2df95065',1470809122983,'0','0','1','0','1','1','0',NULL,NULL,'m','Dr.',NULL,'Nachname','Hauptanwender',NULL,'Beispielstrasse 15','6840','Beispielstrasse 15','0190 222 222',NULL,'0190 222 224',NULL,'haupt@anwender.ch',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'504B0304140008080800F8400A4900000000000000000000000004000000686173685BF39681B5B88841382BB12C51AFB4243347CF23B138A324312927557837BFAAA2D7931DCC0C4C6E0C5C39F989296E89C925F9459E0C9C251945A9C519F939291505F60E0C20C051CE0124B98198B18481DD37312F2531AFA48441CC2F3139232F313755C123B1B4A02431AF3C352F25B5A80200504B070806C4629A7400000077000000504B01021400140008080800F8400A4906C4629A740000007700000004000000000000000000000000000000000068617368504B0506000000000100010032000000A60000000000');
INSERT INTO USER_ (ID, IS_ADMINISTRATOR, SALT, HASHED_PASSWORD, KONTAKT_ID) 
	VALUES ('user', '0', 'd204f347a59112b2', 'bb4f9b2bc53c23544408ddeaadb1e0f4a1fb0612', 'h2c1172107ce2df95065');